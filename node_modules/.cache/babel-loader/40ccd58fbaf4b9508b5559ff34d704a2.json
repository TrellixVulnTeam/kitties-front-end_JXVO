{"ast":null,"code":"// Copyright 2017-2021 @polkadot/util authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { bnToBn } from \"../bn/toBn.js\";\nimport { isBoolean } from \"../is/boolean.js\";\nimport { isUndefined } from \"../is/undefined.js\";\nimport { formatDecimal } from \"./formatDecimal.js\";\nimport { calcSi, findSi, SI, SI_MID } from \"./si.js\";\nvar DEFAULT_DECIMALS = 0;\nvar DEFAULT_UNIT = SI[SI_MID].text;\nvar defaultDecimals = DEFAULT_DECIMALS;\nvar defaultUnit = DEFAULT_UNIT; // Formats a string/number with <prefix>.<postfix><type> notation\n\nfunction _formatBalance(input) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var optDecimals = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : defaultDecimals;\n  var text = bnToBn(input).toString();\n\n  if (text.length === 0 || text === '0') {\n    return '0';\n  } // strip the negative sign so we can work with clean groupings, re-add this in the\n  // end when we return the result (from here on we work with positive numbers)\n\n\n  var isNegative = text[0].startsWith('-');\n\n  if (isNegative) {\n    text = text.substr(1);\n  } // extract options - the boolean case is for backwards-compat\n\n\n  var _ref = isBoolean(options) ? {\n    withSi: options\n  } : options,\n      _ref$decimals = _ref.decimals,\n      decimals = _ref$decimals === void 0 ? optDecimals : _ref$decimals,\n      _ref$forceUnit = _ref.forceUnit,\n      forceUnit = _ref$forceUnit === void 0 ? undefined : _ref$forceUnit,\n      _ref$withSi = _ref.withSi,\n      withSi = _ref$withSi === void 0 ? true : _ref$withSi,\n      _ref$withSiFull = _ref.withSiFull,\n      withSiFull = _ref$withSiFull === void 0 ? false : _ref$withSiFull,\n      _ref$withUnit = _ref.withUnit,\n      withUnit = _ref$withUnit === void 0 ? true : _ref$withUnit; // NOTE We start at midpoint (8) minus 1 - this means that values display as\n  // 123.456 instead of 0.123k (so always 6 relevant). Additionally we use ceil\n  // so there are at most 3 decimal before the decimal separator\n\n\n  var si = calcSi(text, decimals, forceUnit);\n  var mid = text.length - (decimals + si.power);\n  var prefix = text.substr(0, mid);\n  var padding = mid < 0 ? 0 - mid : 0;\n  var postfix = \"\".concat(\"\".concat(new Array(padding + 1).join('0')).concat(text).substr(mid < 0 ? 0 : mid), \"0000\").substr(0, 4);\n  var units = withSi || withSiFull ? si.value === '-' ? withUnit ? \" \".concat(isBoolean(withUnit) ? si.text : withUnit) : '' : \" \".concat(withSiFull ? si.text : si.value).concat(withUnit ? \"\".concat(withSiFull ? ' ' : '').concat(isBoolean(withUnit) ? SI[SI_MID].text : withUnit) : '') : '';\n  return \"\".concat(isNegative ? '-' : '').concat(formatDecimal(prefix || '0'), \".\").concat(postfix).concat(units);\n}\n\nvar formatBalance = _formatBalance; // eslint-disable-next-line @typescript-eslint/unbound-method\n\nformatBalance.calcSi = function (text) {\n  var decimals = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : defaultDecimals;\n  return calcSi(text, decimals);\n}; // eslint-disable-next-line @typescript-eslint/unbound-method\n\n\nformatBalance.findSi = findSi; // eslint-disable-next-line @typescript-eslint/unbound-method\n\nformatBalance.getDefaults = function () {\n  return {\n    decimals: defaultDecimals,\n    unit: defaultUnit\n  };\n}; // get allowable options to display in a dropdown\n// eslint-disable-next-line @typescript-eslint/unbound-method\n\n\nformatBalance.getOptions = function () {\n  var decimals = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : defaultDecimals;\n  return SI.filter(function (_ref2) {\n    var power = _ref2.power;\n    return power < 0 ? decimals + power >= 0 : true;\n  });\n}; // Sets the default decimals to use for formatting (ui-wide)\n// eslint-disable-next-line @typescript-eslint/unbound-method\n\n\nformatBalance.setDefaults = function (_ref3) {\n  var decimals = _ref3.decimals,\n      unit = _ref3.unit;\n  defaultDecimals = isUndefined(decimals) ? defaultDecimals : Array.isArray(decimals) ? decimals[0] : decimals;\n  defaultUnit = isUndefined(unit) ? defaultUnit : Array.isArray(unit) ? unit[0] : unit;\n  SI[SI_MID].text = defaultUnit;\n};\n\nexport { formatBalance };","map":{"version":3,"sources":["/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/@polkadot/util/format/formatBalance.js"],"names":["bnToBn","isBoolean","isUndefined","formatDecimal","calcSi","findSi","SI","SI_MID","DEFAULT_DECIMALS","DEFAULT_UNIT","text","defaultDecimals","defaultUnit","_formatBalance","input","options","optDecimals","toString","length","isNegative","startsWith","substr","withSi","decimals","forceUnit","undefined","withSiFull","withUnit","si","mid","power","prefix","padding","postfix","Array","join","units","value","formatBalance","getDefaults","unit","getOptions","filter","setDefaults","isArray"],"mappings":"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","sourcesContent":["// Copyright 2017-2021 @polkadot/util authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { bnToBn } from \"../bn/toBn.js\";\nimport { isBoolean } from \"../is/boolean.js\";\nimport { isUndefined } from \"../is/undefined.js\";\nimport { formatDecimal } from \"./formatDecimal.js\";\nimport { calcSi, findSi, SI, SI_MID } from \"./si.js\";\nconst DEFAULT_DECIMALS = 0;\nconst DEFAULT_UNIT = SI[SI_MID].text;\nlet defaultDecimals = DEFAULT_DECIMALS;\nlet defaultUnit = DEFAULT_UNIT; // Formats a string/number with <prefix>.<postfix><type> notation\n\nfunction _formatBalance(input, options = true, optDecimals = defaultDecimals) {\n  let text = bnToBn(input).toString();\n\n  if (text.length === 0 || text === '0') {\n    return '0';\n  } // strip the negative sign so we can work with clean groupings, re-add this in the\n  // end when we return the result (from here on we work with positive numbers)\n\n\n  const isNegative = text[0].startsWith('-');\n\n  if (isNegative) {\n    text = text.substr(1);\n  } // extract options - the boolean case is for backwards-compat\n\n\n  const {\n    decimals = optDecimals,\n    forceUnit = undefined,\n    withSi = true,\n    withSiFull = false,\n    withUnit = true\n  } = isBoolean(options) ? {\n    withSi: options\n  } : options; // NOTE We start at midpoint (8) minus 1 - this means that values display as\n  // 123.456 instead of 0.123k (so always 6 relevant). Additionally we use ceil\n  // so there are at most 3 decimal before the decimal separator\n\n  const si = calcSi(text, decimals, forceUnit);\n  const mid = text.length - (decimals + si.power);\n  const prefix = text.substr(0, mid);\n  const padding = mid < 0 ? 0 - mid : 0;\n  const postfix = `${`${new Array(padding + 1).join('0')}${text}`.substr(mid < 0 ? 0 : mid)}0000`.substr(0, 4);\n  const units = withSi || withSiFull ? si.value === '-' ? withUnit ? ` ${isBoolean(withUnit) ? si.text : withUnit}` : '' : ` ${withSiFull ? si.text : si.value}${withUnit ? `${withSiFull ? ' ' : ''}${isBoolean(withUnit) ? SI[SI_MID].text : withUnit}` : ''}` : '';\n  return `${isNegative ? '-' : ''}${formatDecimal(prefix || '0')}.${postfix}${units}`;\n}\n\nconst formatBalance = _formatBalance; // eslint-disable-next-line @typescript-eslint/unbound-method\n\nformatBalance.calcSi = (text, decimals = defaultDecimals) => calcSi(text, decimals); // eslint-disable-next-line @typescript-eslint/unbound-method\n\n\nformatBalance.findSi = findSi; // eslint-disable-next-line @typescript-eslint/unbound-method\n\nformatBalance.getDefaults = () => {\n  return {\n    decimals: defaultDecimals,\n    unit: defaultUnit\n  };\n}; // get allowable options to display in a dropdown\n// eslint-disable-next-line @typescript-eslint/unbound-method\n\n\nformatBalance.getOptions = (decimals = defaultDecimals) => {\n  return SI.filter(({\n    power\n  }) => power < 0 ? decimals + power >= 0 : true);\n}; // Sets the default decimals to use for formatting (ui-wide)\n// eslint-disable-next-line @typescript-eslint/unbound-method\n\n\nformatBalance.setDefaults = ({\n  decimals,\n  unit\n}) => {\n  defaultDecimals = isUndefined(decimals) ? defaultDecimals : Array.isArray(decimals) ? decimals[0] : decimals;\n  defaultUnit = isUndefined(unit) ? defaultUnit : Array.isArray(unit) ? unit[0] : unit;\n  SI[SI_MID].text = defaultUnit;\n};\n\nexport { formatBalance };"]},"metadata":{},"sourceType":"module"}