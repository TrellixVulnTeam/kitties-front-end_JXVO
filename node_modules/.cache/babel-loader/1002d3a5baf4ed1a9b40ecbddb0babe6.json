{"ast":null,"code":"// Copyright 2017-2021 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { map, switchMap } from 'rxjs';\nimport { arrayFlatten } from '@polkadot/util';\nimport { memo } from \"../util/index.js\";\nvar DEFAULT_FLAGS = {\n  withController: true,\n  withExposure: true,\n  withPrefs: true\n};\n\nfunction combineAccounts(nextElected, validators) {\n  return arrayFlatten([nextElected, validators.filter(function (v) {\n    return !nextElected.find(function (n) {\n      return n.eq(v);\n    });\n  })]);\n}\n\nexport function electedInfo(instanceId, api) {\n  return memo(instanceId, function () {\n    var flags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_FLAGS;\n    return api.derive.staking.validators().pipe(switchMap(function (_ref) {\n      var nextElected = _ref.nextElected,\n          validators = _ref.validators;\n      return api.derive.staking.queryMulti(combineAccounts(nextElected, validators), flags).pipe(map(function (info) {\n        return {\n          info: info,\n          nextElected: nextElected,\n          validators: validators\n        };\n      }));\n    }));\n  });\n}","map":{"version":3,"sources":["/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/@polkadot/api-derive/staking/electedInfo.js"],"names":["map","switchMap","arrayFlatten","memo","DEFAULT_FLAGS","withController","withExposure","withPrefs","combineAccounts","nextElected","validators","filter","v","find","n","eq","electedInfo","instanceId","api","flags","derive","staking","pipe","queryMulti","info"],"mappings":"AAAA;AACA;AACA,SAASA,GAAT,EAAcC,SAAd,QAA+B,MAA/B;AACA,SAASC,YAAT,QAA6B,gBAA7B;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,IAAMC,aAAa,GAAG;AACpBC,EAAAA,cAAc,EAAE,IADI;AAEpBC,EAAAA,YAAY,EAAE,IAFM;AAGpBC,EAAAA,SAAS,EAAE;AAHS,CAAtB;;AAMA,SAASC,eAAT,CAAyBC,WAAzB,EAAsCC,UAAtC,EAAkD;AAChD,SAAOR,YAAY,CAAC,CAACO,WAAD,EAAcC,UAAU,CAACC,MAAX,CAAkB,UAAAC,CAAC;AAAA,WAAI,CAACH,WAAW,CAACI,IAAZ,CAAiB,UAAAC,CAAC;AAAA,aAAIA,CAAC,CAACC,EAAF,CAAKH,CAAL,CAAJ;AAAA,KAAlB,CAAL;AAAA,GAAnB,CAAd,CAAD,CAAnB;AACD;;AAED,OAAO,SAASI,WAAT,CAAqBC,UAArB,EAAiCC,GAAjC,EAAsC;AAC3C,SAAOf,IAAI,CAACc,UAAD,EAAa;AAAA,QAACE,KAAD,uEAASf,aAAT;AAAA,WAA2Bc,GAAG,CAACE,MAAJ,CAAWC,OAAX,CAAmBX,UAAnB,GAAgCY,IAAhC,CAAqCrB,SAAS,CAAC;AAAA,UAChGQ,WADgG,QAChGA,WADgG;AAAA,UAEhGC,UAFgG,QAEhGA,UAFgG;AAAA,aAG5FQ,GAAG,CAACE,MAAJ,CAAWC,OAAX,CAAmBE,UAAnB,CAA8Bf,eAAe,CAACC,WAAD,EAAcC,UAAd,CAA7C,EAAwES,KAAxE,EAA+EG,IAA/E,CAAoFtB,GAAG,CAAC,UAAAwB,IAAI;AAAA,eAAK;AACrGA,UAAAA,IAAI,EAAJA,IADqG;AAErGf,UAAAA,WAAW,EAAXA,WAFqG;AAGrGC,UAAAA,UAAU,EAAVA;AAHqG,SAAL;AAAA,OAAL,CAAvF,CAH4F;AAAA,KAAD,CAA9C,CAA3B;AAAA,GAAb,CAAX;AAQD","sourcesContent":["// Copyright 2017-2021 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { map, switchMap } from 'rxjs';\nimport { arrayFlatten } from '@polkadot/util';\nimport { memo } from \"../util/index.js\";\nconst DEFAULT_FLAGS = {\n  withController: true,\n  withExposure: true,\n  withPrefs: true\n};\n\nfunction combineAccounts(nextElected, validators) {\n  return arrayFlatten([nextElected, validators.filter(v => !nextElected.find(n => n.eq(v)))]);\n}\n\nexport function electedInfo(instanceId, api) {\n  return memo(instanceId, (flags = DEFAULT_FLAGS) => api.derive.staking.validators().pipe(switchMap(({\n    nextElected,\n    validators\n  }) => api.derive.staking.queryMulti(combineAccounts(nextElected, validators), flags).pipe(map(info => ({\n    info,\n    nextElected,\n    validators\n  }))))));\n}"]},"metadata":{},"sourceType":"module"}