{"ast":null,"code":"import _slicedToArray from \"/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n// Copyright 2017-2021 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { combineLatest, map, of, switchMap } from 'rxjs';\nimport { createSignedBlockExtended } from \"../type/index.js\";\nimport { memo } from \"../util/index.js\";\n/**\n * @name subscribeNewBlocks\n * @returns The latest block & events for that block\n */\n\nexport function subscribeNewBlocks(instanceId, api) {\n  return memo(instanceId, function () {\n    return api.derive.chain.subscribeNewHeads().pipe(switchMap(function (header) {\n      var blockHash = header.createdAtHash || header.hash;\n      return combineLatest(api.rpc.chain.getBlock(blockHash), api.query.system.events.at(blockHash), of(header));\n    }), map(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 3),\n          block = _ref2[0],\n          events = _ref2[1],\n          header = _ref2[2];\n\n      return createSignedBlockExtended(block.registry, block, events, header.validators);\n    }));\n  });\n}","map":{"version":3,"sources":["/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/@polkadot/api-derive/chain/subscribeNewBlocks.js"],"names":["combineLatest","map","of","switchMap","createSignedBlockExtended","memo","subscribeNewBlocks","instanceId","api","derive","chain","subscribeNewHeads","pipe","header","blockHash","createdAtHash","hash","rpc","getBlock","query","system","events","at","block","registry","validators"],"mappings":";AAAA;AACA;AACA,SAASA,aAAT,EAAwBC,GAAxB,EAA6BC,EAA7B,EAAiCC,SAAjC,QAAkD,MAAlD;AACA,SAASC,yBAAT,QAA0C,kBAA1C;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA;AACA;AACA;AACA;;AAEA,OAAO,SAASC,kBAAT,CAA4BC,UAA5B,EAAwCC,GAAxC,EAA6C;AAClD,SAAOH,IAAI,CAACE,UAAD,EAAa;AAAA,WAAMC,GAAG,CAACC,MAAJ,CAAWC,KAAX,CAAiBC,iBAAjB,GAAqCC,IAArC,CAA0CT,SAAS,CAAC,UAAAU,MAAM,EAAI;AAC1F,UAAMC,SAAS,GAAGD,MAAM,CAACE,aAAP,IAAwBF,MAAM,CAACG,IAAjD;AACA,aAAOhB,aAAa,CAACQ,GAAG,CAACS,GAAJ,CAAQP,KAAR,CAAcQ,QAAd,CAAuBJ,SAAvB,CAAD,EAAoCN,GAAG,CAACW,KAAJ,CAAUC,MAAV,CAAiBC,MAAjB,CAAwBC,EAAxB,CAA2BR,SAA3B,CAApC,EAA2EZ,EAAE,CAACW,MAAD,CAA7E,CAApB;AACD,KAHgF,CAAnD,EAG1BZ,GAAG,CAAC;AAAA;AAAA,UAAEsB,KAAF;AAAA,UAASF,MAAT;AAAA,UAAiBR,MAAjB;;AAAA,aAA6BT,yBAAyB,CAACmB,KAAK,CAACC,QAAP,EAAiBD,KAAjB,EAAwBF,MAAxB,EAAgCR,MAAM,CAACY,UAAvC,CAAtD;AAAA,KAAD,CAHuB,CAAN;AAAA,GAAb,CAAX;AAID","sourcesContent":["// Copyright 2017-2021 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { combineLatest, map, of, switchMap } from 'rxjs';\nimport { createSignedBlockExtended } from \"../type/index.js\";\nimport { memo } from \"../util/index.js\";\n/**\n * @name subscribeNewBlocks\n * @returns The latest block & events for that block\n */\n\nexport function subscribeNewBlocks(instanceId, api) {\n  return memo(instanceId, () => api.derive.chain.subscribeNewHeads().pipe(switchMap(header => {\n    const blockHash = header.createdAtHash || header.hash;\n    return combineLatest(api.rpc.chain.getBlock(blockHash), api.query.system.events.at(blockHash), of(header));\n  }), map(([block, events, header]) => createSignedBlockExtended(block.registry, block, events, header.validators))));\n}"]},"metadata":{},"sourceType":"module"}