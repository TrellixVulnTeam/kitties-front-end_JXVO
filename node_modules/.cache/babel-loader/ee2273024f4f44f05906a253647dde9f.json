{"ast":null,"code":"import _defineProperty from\"/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{Button,Card,Grid,Message,Modal,Form,Label}from'semantic-ui-react';import KittyAvatar from'./KittyAvatar';import{TxButton}from'./substrate-lib/components';// --- About Modal ---\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TransferModal=function TransferModal(props){var kitty=props.kitty,accountPair=props.accountPair,setStatus=props.setStatus;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),open=_React$useState2[0],setOpen=_React$useState2[1];var _React$useState3=React.useState({}),_React$useState4=_slicedToArray(_React$useState3,2),formValue=_React$useState4[0],setFormValue=_React$useState4[1];var formChange=function formChange(key){return function(ev,el){setFormValue(_objectSpread(_objectSpread({},formValue),{},_defineProperty({},key,el.value)));};};var confirmAndClose=function confirmAndClose(unsub){unsub();setOpen(false);};return/*#__PURE__*/_jsxs(Modal,{onClose:function onClose(){return setOpen(false);},onOpen:function onOpen(){return setOpen(true);},open:open,trigger:/*#__PURE__*/_jsx(Button,{basic:true,color:\"blue\",children:\"\\u8F6C\\u8BA9\"}),children:[/*#__PURE__*/_jsx(Modal.Header,{children:\"\\u6BDB\\u5B69\\u8F6C\\u8BA9\"}),/*#__PURE__*/_jsx(Modal.Content,{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsx(Form.Input,{fluid:true,label:\"\\u6BDB\\u5B69 ID\",readOnly:true,value:kitty.id}),/*#__PURE__*/_jsx(Form.Input,{fluid:true,label:\"\\u8F6C\\u8BA9\\u5BF9\\u8C61\",placeholder:\"\\u5BF9\\u65B9\\u5730\\u5740\",onChange:formChange('target')})]})}),/*#__PURE__*/_jsxs(Modal.Actions,{children:[/*#__PURE__*/_jsx(Button,{basic:true,color:\"grey\",onClick:function onClick(){return setOpen(false);},children:\"\\u53D6\\u6D88\"}),/*#__PURE__*/_jsx(TxButton,{accountPair:accountPair,label:\"\\u786E\\u8BA4\\u8F6C\\u8BA9\",type:\"SIGNED-TX\",setStatus:setStatus,onClick:confirmAndClose,attrs:{palletRpc:'kittiesModule',callable:'transfer',inputParams:[formValue.target,kitty.id],paramFields:[true,true]}})]})]});};// --- About Kitty Card ---\nvar KittyCard=function KittyCard(props){var kitty=props.kitty,accountPair=props.accountPair,setStatus=props.setStatus;var _kitty$id=kitty.id,id=_kitty$id===void 0?null:_kitty$id,_kitty$dna=kitty.dna,dna=_kitty$dna===void 0?null:_kitty$dna,_kitty$owner=kitty.owner,owner=_kitty$owner===void 0?null:_kitty$owner;var displayDna=dna&&dna.join(', ');var displayId=id===null?'':id<10?\"0\".concat(id):id.toString();var isSelf=accountPair.address===kitty.owner;return/*#__PURE__*/_jsxs(Card,{children:[isSelf&&/*#__PURE__*/_jsx(Label,{as:\"a\",floating:true,color:\"teal\",children:\"\\u6211\\u7684\"}),/*#__PURE__*/_jsx(KittyAvatar,{dna:dna}),/*#__PURE__*/_jsxs(Card.Content,{children:[/*#__PURE__*/_jsxs(Card.Header,{children:[\"ID \\u53F7: \",displayId]}),/*#__PURE__*/_jsxs(Card.Meta,{style:{overflowWrap:'break-word'},children:[\"\\u57FA\\u56E0: \",/*#__PURE__*/_jsx(\"br\",{}),displayDna]}),/*#__PURE__*/_jsx(Card.Description,{children:/*#__PURE__*/_jsxs(\"p\",{style:{overflowWrap:'break-word'},children:[\"\\u732B\\u5974:\",/*#__PURE__*/_jsx(\"br\",{}),owner]})})]}),/*#__PURE__*/_jsx(Card.Content,{extra:true,style:{textAlign:'center'},children:owner===accountPair.address?/*#__PURE__*/_jsx(TransferModal,{kitty:kitty,accountPair:accountPair,setStatus:setStatus}):''})]});};var KittyCards=function KittyCards(props){var kitties=props.kitties,accountPair=props.accountPair,setStatus=props.setStatus;if(kitties.length===0){return/*#__PURE__*/_jsx(Message,{info:true,children:/*#__PURE__*/_jsxs(Message.Header,{children:[\"\\u73B0\\u5728\\u8FDE\\u4E00\\u53EA\\u6BDB\\u5B69\\u90FD\\u6728\\u6709\\uFF0C\\u8D76\\u5FEB\\u521B\\u5EFA\\u4E00\\u53EA\\xA0\",/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"point-down\",children:\"\\uD83D\\uDC47\"})]})});}return/*#__PURE__*/_jsx(Grid,{columns:3,children:kitties.map(function(kitty,i){return/*#__PURE__*/_jsx(Grid.Column,{children:/*#__PURE__*/_jsx(KittyCard,{kitty:kitty,accountPair:accountPair,setStatus:setStatus})},\"kitty-\".concat(i));})});};export default KittyCards;","map":{"version":3,"sources":["/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/src/KittyCards.js"],"names":["React","Button","Card","Grid","Message","Modal","Form","Label","KittyAvatar","TxButton","TransferModal","props","kitty","accountPair","setStatus","useState","open","setOpen","formValue","setFormValue","formChange","key","ev","el","value","confirmAndClose","unsub","id","palletRpc","callable","inputParams","target","paramFields","KittyCard","dna","owner","displayDna","join","displayId","toString","isSelf","address","overflowWrap","textAlign","KittyCards","kitties","length","map","i"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { Button, Card, Grid, Message, Modal, Form, Label } from 'semantic-ui-react'\n\nimport KittyAvatar from './KittyAvatar'\nimport { TxButton } from './substrate-lib/components'\n\n// --- About Modal ---\n\nconst TransferModal = props => {\n  const { kitty, accountPair, setStatus } = props\n  const [open, setOpen] = React.useState(false)\n  const [formValue, setFormValue] = React.useState({})\n\n  const formChange = key => (ev, el) => {\n    setFormValue({ ...formValue, [key]: el.value })\n  }\n\n  const confirmAndClose = (unsub) => {\n    unsub()\n    setOpen(false)\n  }\n\n  return <Modal onClose={() => setOpen(false)} onOpen={() => setOpen(true)} open={open}\n    trigger={<Button basic color='blue'>转让</Button>}>\n    <Modal.Header>毛孩转让</Modal.Header>\n    <Modal.Content><Form>\n      <Form.Input fluid label='毛孩 ID' readOnly value={kitty.id}/>\n      <Form.Input fluid label='转让对象' placeholder='对方地址' onChange={formChange('target')}/>\n    </Form></Modal.Content>\n    <Modal.Actions>\n      <Button basic color='grey' onClick={() => setOpen(false)}>取消</Button>\n      <TxButton\n        accountPair={accountPair} label='确认转让' type='SIGNED-TX' setStatus={setStatus}\n        onClick={confirmAndClose}\n        attrs={{\n          palletRpc: 'kittiesModule',\n          callable: 'transfer',\n          inputParams: [formValue.target, kitty.id],\n          paramFields: [true, true]\n        }}\n      />\n    </Modal.Actions>\n  </Modal>\n}\n\n// --- About Kitty Card ---\n\nconst KittyCard = props => {\n  const { kitty, accountPair, setStatus } = props\n  const { id = null, dna = null, owner = null } = kitty\n  const displayDna = dna && dna.join(', ')\n  const displayId = id === null ? '' : (id < 10 ? `0${id}` : id.toString())\n  const isSelf = accountPair.address === kitty.owner\n\n  return <Card>\n    { isSelf && <Label as='a' floating color='teal'>我的</Label> }\n    <KittyAvatar dna={dna} />\n    <Card.Content>\n      <Card.Header>ID 号: {displayId}</Card.Header>\n      <Card.Meta style={{ overflowWrap: 'break-word' }}>\n        基因: <br/>\n        {displayDna}\n      </Card.Meta>\n      <Card.Description>\n        <p style={{ overflowWrap: 'break-word' }}>\n          猫奴:<br/>\n          {owner}\n        </p>\n      </Card.Description>\n    </Card.Content>\n    <Card.Content extra style={{ textAlign: 'center' }}>{ owner === accountPair.address\n      ? <TransferModal kitty={kitty} accountPair={accountPair} setStatus={setStatus}/>\n      : ''\n    }</Card.Content>\n  </Card>\n}\n\nconst KittyCards = props => {\n  const { kitties, accountPair, setStatus } = props\n\n  if (kitties.length === 0) {\n    return <Message info>\n      <Message.Header>现在连一只毛孩都木有，赶快创建一只&nbsp;\n        <span role='img' aria-label='point-down'>👇</span>\n      </Message.Header>\n    </Message>\n  }\n\n  return <Grid columns={3}>{kitties.map((kitty, i) =>\n    <Grid.Column key={`kitty-${i}`}>\n      <KittyCard kitty={kitty} accountPair={accountPair} setStatus={setStatus}/>\n    </Grid.Column>\n  )}</Grid>\n}\n\nexport default KittyCards\n"]},"metadata":{},"sourceType":"module"}