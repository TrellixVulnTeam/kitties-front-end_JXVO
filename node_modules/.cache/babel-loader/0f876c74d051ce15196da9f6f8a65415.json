{"ast":null,"code":"import _slicedToArray from \"/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n// Copyright 2017-2021 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { combineLatest, map, switchMap } from 'rxjs';\nimport { memo } from \"../util/index.js\";\nvar DEFAULT_FLAGS = {\n  withController: true,\n  withPrefs: true\n};\nexport function waitingInfo(instanceId, api) {\n  return memo(instanceId, function () {\n    var flags = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : DEFAULT_FLAGS;\n    return combineLatest([api.derive.staking.validators(), api.derive.staking.stashes()]).pipe(switchMap(function (_ref) {\n      var _ref2 = _slicedToArray(_ref, 2),\n          nextElected = _ref2[0].nextElected,\n          stashes = _ref2[1];\n\n      var elected = nextElected.map(function (a) {\n        return a.toString();\n      });\n      var waiting = stashes.filter(function (v) {\n        return !elected.includes(v.toString());\n      });\n      return api.derive.staking.queryMulti(waiting, flags).pipe(map(function (info) {\n        return {\n          info: info,\n          waiting: waiting\n        };\n      }));\n    }));\n  });\n}","map":{"version":3,"sources":["/home/spren/workspace/slides/advanced/term-03/03_polkadot-js-api/kitties/frontend/node_modules/@polkadot/api-derive/staking/waitingInfo.js"],"names":["combineLatest","map","switchMap","memo","DEFAULT_FLAGS","withController","withPrefs","waitingInfo","instanceId","api","flags","derive","staking","validators","stashes","pipe","nextElected","elected","a","toString","waiting","filter","v","includes","queryMulti","info"],"mappings":";AAAA;AACA;AACA,SAASA,aAAT,EAAwBC,GAAxB,EAA6BC,SAA7B,QAA8C,MAA9C;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,IAAMC,aAAa,GAAG;AACpBC,EAAAA,cAAc,EAAE,IADI;AAEpBC,EAAAA,SAAS,EAAE;AAFS,CAAtB;AAIA,OAAO,SAASC,WAAT,CAAqBC,UAArB,EAAiCC,GAAjC,EAAsC;AAC3C,SAAON,IAAI,CAACK,UAAD,EAAa;AAAA,QAACE,KAAD,uEAASN,aAAT;AAAA,WAA2BJ,aAAa,CAAC,CAACS,GAAG,CAACE,MAAJ,CAAWC,OAAX,CAAmBC,UAAnB,EAAD,EAAkCJ,GAAG,CAACE,MAAJ,CAAWC,OAAX,CAAmBE,OAAnB,EAAlC,CAAD,CAAb,CAA+EC,IAA/E,CAAoFb,SAAS,CAAC,gBAEjI;AAAA;AAAA,UADdc,WACc,YADdA,WACc;AAAA,UAAbF,OAAa;;AACd,UAAMG,OAAO,GAAGD,WAAW,CAACf,GAAZ,CAAgB,UAAAiB,CAAC;AAAA,eAAIA,CAAC,CAACC,QAAF,EAAJ;AAAA,OAAjB,CAAhB;AACA,UAAMC,OAAO,GAAGN,OAAO,CAACO,MAAR,CAAe,UAAAC,CAAC;AAAA,eAAI,CAACL,OAAO,CAACM,QAAR,CAAiBD,CAAC,CAACH,QAAF,EAAjB,CAAL;AAAA,OAAhB,CAAhB;AACA,aAAOV,GAAG,CAACE,MAAJ,CAAWC,OAAX,CAAmBY,UAAnB,CAA8BJ,OAA9B,EAAuCV,KAAvC,EAA8CK,IAA9C,CAAmDd,GAAG,CAAC,UAAAwB,IAAI;AAAA,eAAK;AACrEA,UAAAA,IAAI,EAAJA,IADqE;AAErEL,UAAAA,OAAO,EAAPA;AAFqE,SAAL;AAAA,OAAL,CAAtD,CAAP;AAID,KAT+I,CAA7F,CAA3B;AAAA,GAAb,CAAX;AAUD","sourcesContent":["// Copyright 2017-2021 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { combineLatest, map, switchMap } from 'rxjs';\nimport { memo } from \"../util/index.js\";\nconst DEFAULT_FLAGS = {\n  withController: true,\n  withPrefs: true\n};\nexport function waitingInfo(instanceId, api) {\n  return memo(instanceId, (flags = DEFAULT_FLAGS) => combineLatest([api.derive.staking.validators(), api.derive.staking.stashes()]).pipe(switchMap(([{\n    nextElected\n  }, stashes]) => {\n    const elected = nextElected.map(a => a.toString());\n    const waiting = stashes.filter(v => !elected.includes(v.toString()));\n    return api.derive.staking.queryMulti(waiting, flags).pipe(map(info => ({\n      info,\n      waiting\n    })));\n  })));\n}"]},"metadata":{},"sourceType":"module"}